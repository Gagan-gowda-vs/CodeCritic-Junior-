<!DOCTYPE html>
<html>
<head>
    <title>Backtracking Visualizer (N-Queens)</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 40px auto;
            background: rgba(255, 255, 255, 0.05);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: fadeIn 0.5s ease-out;
        }

        h2 {
            text-align: center;
            margin-bottom: 20px;
            color: #fff;
            font-size: 2em;
            font-weight: 600;
        }

        #complexity {
            text-align: center;
            margin-bottom: 25px;
            font-size: 1.1em;
            color: #a0a0a0;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        #controls {
            margin-bottom: 25px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        #controls input {
            padding: 12px 15px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.05);
            color: #fff;
            font-size: 14px;
            width: 250px;
            transition: all 0.3s ease;
        }

        #controls input:focus {
            outline: none;
            border-color: #4a90e2;
            box-shadow: 0 0 0 3px rgba(74, 144, 226, 0.2);
        }

        button {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            background: #4a90e2;
            color: white;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        button:hover {
            background: #357abd;
            transform: translateY(-2px);
        }

        #step-controls {
            margin-bottom: 25px;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        #step-controls button {
            background: #2c3e50;
        }

        #step-controls button:hover {
            background: #34495e;
        }

        #playPauseBtn {
            background: #27ae60;
        }

        #playPauseBtn:hover {
            background: #219a52;
        }

        .grid {
            display: grid;
            gap: 2px;
            margin: 40px auto;
            background: rgba(255, 255, 255, 0.1);
            padding: 2px;
            border-radius: 12px;
            max-width: fit-content;
        }

        .cell {
            width: 60px;
            height: 60px;
            background: #2c3e50;
            color: #fff;
            font-size: 1.5em;
            font-weight: 600;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: all 0.5s cubic-bezier(.68,-0.55,.27,1.55);
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        .cell.empty { 
            background: #2c3e50;
            color: #fff;
        }

        .cell.current { 
            background: #e74c3c;
            color: #fff;
            transform: scale(1.1);
            z-index: 2;
        }

        .cell.valid { 
            background: #27ae60;
            color: #fff;
            z-index: 2;
        }

        .cell.invalid { 
            background: #c0392b;
            color: #fff;
            z-index: 2;
        }

        .cell.backtrack { 
            background: #95a5a6;
            color: #fff;
            z-index: 2;
        }

        #legend {
            margin: 25px 0;
            display: flex;
            gap: 25px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #a0a0a0;
        }

        .legend-color {
            width: 25px;
            height: 25px;
            border-radius: 8px;
            display: inline-block;
            border: 2px solid rgba(255, 255, 255, 0.1);
        }

        #counters {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-bottom: 20px;
            font-size: 1.1em;
            color: #a0a0a0;
        }

        #caption {
            text-align: center;
            margin-top: 25px;
            font-size: 1.2em;
            min-height: 1.5em;
            color: #fff;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            animation: fadeIn 0.3s ease-out;
        }

        #speed-control {
            -webkit-appearance: none;
            width: 150px;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            outline: none;
        }

        #speed-control::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: #4a90e2;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        #speed-control::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        #step-indicator, #pass-indicator {
            color: #a0a0a0;
            font-size: 1.1em;
            padding: 8px 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }

        #speed-label {
            color: #a0a0a0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Backtracking Visualizer: N-Queens</h2>
        <div id="controls">
            <label>N (size): <input id="n-input" type="number" min="4" max="10" value="4"></label>
            <button onclick="prepareSteps()">Visualize</button>
            <button id="reset-btn" onclick="resetVisualizer()">Reset</button>
        </div>
        <div id="step-controls">
            <button onclick="prevStep()">&#8592; Previous</button>
            <button id="playPauseBtn" onclick="togglePlay()">Play</button>
            <button onclick="nextStep()">Next &#8594;</button>
            <span id="step-indicator"></span>
            <label id="speed-label" for="speed-control" style="margin-left:24px;">Speed:</label>
            <input id="speed-control" type="range" min="200" max="2000" value="900" step="100" style="vertical-align:middle;">
        </div>
        <div id="legend">
            <span class="legend-item"><span class="legend-color" style="background:#ffb300"></span>Queen</span>
            <span class="legend-item"><span class="legend-color" style="background:#039be5"></span>Trying</span>
            <span class="legend-item"><span class="legend-color" style="background:#e53935"></span>Conflict</span>
            <span class="legend-item"><span class="legend-color" style="background:#43a047"></span>Solution</span>
        </div>
        <div class="board-center">
            <div class="chess-board" id="chess-board"></div>
        </div>
        <div id="caption"></div>
    </div>
    <script>
    let steps = [];
    let currentStep = 0;
    let playInterval = null;

    function prepareSteps() {
        let n = parseInt(document.getElementById('n-input').value);
        if (isNaN(n) || n < 4 || n > 10) return alert('N must be between 4 and 10');
        steps = [];
        let board = Array.from({length: n}, () => Array(n).fill(0));
        let queens = [];
        let foundSolution = false;

        function isSafe(row, col, queens) {
            for (let [r, c] of queens) {
                if (c === col || r + c === row + col || r - c === row - col) return false;
            }
            return true;
        }

        function recordStep(type, queens, tryRow, tryCol, conflict=false, solution=false, conflictAxes={}) {
            let n = board.length;
            let cells = Array.from({length: n}, () => Array(n).fill(''));
            for (let [r, c] of queens) cells[r][c] = 'queen';
            if (tryRow !== null && tryCol !== null) {
                cells[tryRow][tryCol] = conflict ? 'conflict' : (solution ? 'solution' : 'trying');
            }
            steps.push({
                cells: cells,
                queens: queens.slice(),
                tryRow, tryCol,
                conflict,
                solution,
                conflictAxes
            });
        }

        function solve(row) {
            if (row === n) {
                // Solution found
                recordStep('solution', queens, null, null, false, true);
                foundSolution = true;
                return;
            }
            for (let col = 0; col < n; col++) {
                let axes = {};
                let is_conflict = false;
                for (let [r, c] of queens) {
                    if (c === col) { axes.col = true; is_conflict = true; }
                    if (r + c === row + col) { axes.diag1 = true; is_conflict = true; }
                    if (r - c === row - col) { axes.diag2 = true; is_conflict = true; }
                }
                recordStep('try', queens, row, col, false, false);
                if (!is_conflict) {
                    queens.push([row, col]);
                    recordStep('place', queens, row, col, false, false);
                    solve(row + 1);
                    if (foundSolution) return;
                    queens.pop();
                } else {
                    recordStep('conflict', queens, row, col, true, false, axes);
                }
            }
        }

        solve(0);
        currentStep = 0;
        showStep(0, true);
    }

    function showStep(idx, instant=false) {
        if (idx < 0 || idx >= steps.length) return;
        currentStep = idx;
        const step = steps[idx];
        const boardDiv = document.getElementById('chess-board');
        boardDiv.innerHTML = '';
        let n = step.cells.length;
        for (let r = 0; r < n; r++) {
            const rowDiv = document.createElement('div');
            rowDiv.className = 'board-row';
            for (let c = 0; c < n; c++) {
                const cellDiv = document.createElement('div');
                cellDiv.className = 'cell ' + ((r + c) % 2 === 0 ? 'even' : 'odd');
                if (step.cells[r][c] === 'queen') cellDiv.classList.add('queen');
                if (step.cells[r][c] === 'trying') cellDiv.classList.add('trying');
                if (step.cells[r][c] === 'conflict') {
                    cellDiv.classList.add('conflict');
                    if (step.conflictAxes) {
                        if (step.conflictAxes.col && c === step.tryCol) cellDiv.classList.add('conflict-col');
                        if (step.conflictAxes.row && r === step.tryRow) cellDiv.classList.add('conflict-row');
                        if (step.conflictAxes.diag1 && (r - c === step.tryRow - step.tryCol)) cellDiv.classList.add('conflict-diag1');
                        if (step.conflictAxes.diag2 && (r + c === step.tryRow + step.tryCol)) cellDiv.classList.add('conflict-diag2');
                    }
                }
                if (step.cells[r][c] === 'solution') cellDiv.classList.add('solution');
                cellDiv.textContent = step.cells[r][c] === 'queen' || step.cells[r][c] === 'solution' ? '♛' : '';
                rowDiv.appendChild(cellDiv);
            }
            boardDiv.appendChild(rowDiv);
        }
        document.getElementById('step-indicator').textContent = `Step ${idx+1} / ${steps.length}`;
        if (step.solution) {
            document.getElementById('caption').textContent = `Solution found!`;
        } else if (step.conflict) {
            document.getElementById('caption').textContent = `Conflict at row ${step.tryRow+1}, col ${step.tryCol+1}.`;
        } else if (step.tryRow !== null && step.tryCol !== null) {
            document.getElementById('caption').textContent = `Trying to place queen at row ${step.tryRow+1}, col ${step.tryCol+1}.`;
        } else {
            document.getElementById('caption').textContent = '';
        }
    }

    function nextStep() {
        if (currentStep < steps.length - 1) {
            showStep(currentStep + 1);
        }
    }
    function prevStep() {
        if (currentStep > 0) {
            showStep(currentStep - 1, true);
        }
    }

    function getSpeed() {
        const slider = document.getElementById('speed-control');
        const min = parseInt(slider.min);
        const max = parseInt(slider.max);
        const val = parseInt(slider.value);
        return max + min - val;
    }

    function togglePlay() {
        const btn = document.getElementById('playPauseBtn');
        const speed = getSpeed();
        if (playInterval) {
            clearInterval(playInterval);
            playInterval = null;
            btn.textContent = "Play";
        } else {
            btn.textContent = "Pause";
            playInterval = setInterval(() => {
                if (currentStep < steps.length - 1) {
                    nextStep();
                } else {
                    clearInterval(playInterval);
                    playInterval = null;
                    btn.textContent = "Play";
                }
            }, speed);
        }
    }

    document.getElementById('speed-control').addEventListener('input', function() {
        if (playInterval) {
            togglePlay();
            togglePlay();
        }
    });

    function resetVisualizer() {
        if (playInterval) togglePlay();
        currentStep = 0;
        showStep(0, true);
    }

    // Initial render
    prepareSteps();
    </script>
</body>
</html>